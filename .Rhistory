DAX.dates <- fmt.by.date(csv.DAX$Date, csv.DAX$Date,
DE.CVD.dates.min.max[1], DE.CVD.dates.min.max[2])
# === 4) analysis for percent difference =======================================
# section finds percent difference between index stock price high and low
# as a measurement of stock market volatility
# correlation is run for daily cases and index stock percent difference
# csv files are saved from dataframes for the creation of figures
# function to calculate percent difference between two values
percent.dif <- function(x,y){
top <- x-y
bottom <- (x+y)/2
final <- (top/bottom)*100
return(final)
}
# Create data frames to run correlation between
# daily covid cases and percent difference between
# index stock price high and low
# create vectors for daily percent differences in stock price
# for each index by USA covid dates
# SP500
SP500.diff <- abs(percent.dif((fmt.by.date(csv.SP500$Low, csv.SP500$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2])),
(fmt.by.date(csv.SP500$High, csv.SP500$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2]))))
# NASDAQ
NASDAQ.diff <- abs(percent.dif((fmt.by.date(csv.NASDAQ$Low, csv.NASDAQ$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2])),
(fmt.by.date(csv.NASDAQ$High, csv.NASDAQ$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2]))))
# DJI
DJI.diff <- abs(percent.dif((fmt.by.date(csv.DJI$Low, csv.DJI$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2])),
(fmt.by.date(csv.DJI$High, csv.DJI$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2]))))
# create vectors for daily percent differences in stock price
# TSX
TSX.diff <- abs(percent.dif((fmt.by.date(csv.TSX$Low, csv.TSX$Date,
CAN.CVD.dates.min.max[1],
CAN.CVD.dates.min.max[2])),
(fmt.by.date(csv.TSX$High, csv.TSX$Date,
CAN.CVD.dates.min.max[1],
CAN.CVD.dates.min.max[2]))))
# create vectors for daily percent differences in stock price
# DAX
DAX.diff <- abs(percent.dif((fmt.by.date(csv.DAX$Low, csv.DAX$Date,
DE.CVD.dates.min.max[1],
DE.CVD.dates.min.max[2])),
(fmt.by.date(csv.DAX$High, csv.DAX$Date,
DE.CVD.dates.min.max[1],
DE.CVD.dates.min.max[2]))))
# create data frame for daily percent differences in stock price from each index
# by associated dates sorted by covid data
# SP500
SP500.df.diff <- cbind.data.frame(SP500.dates, SP500.diff)
# NASDAQ
NASDAQ.df.diff <- cbind.data.frame(NASDAQ.dates, NASDAQ.diff)
# DJI
DJI.df.diff <- cbind.data.frame(DJI.dates, DJI.diff)
# TSX
TSX.df.diff <- cbind.data.frame(TSX.dates, TSX.diff)
# DAX
DAX.df.diff <- cbind.data.frame(DAX.dates, DAX.diff)
# rename column names for index data frame dates to "Date"
names(SP500.df.diff)[names(SP500.df.diff) == "SP500.dates"] <- "Date"
names(NASDAQ.df.diff)[names(NASDAQ.df.diff) == "NASDAQ.dates"] <- "Date"
names(DJI.df.diff)[names(DJI.df.diff) == "DJI.dates"] <- "Date"
names(TSX.df.diff)[names(TSX.df.diff) == "TSX.dates"] <- "Date"
names(DAX.df.diff)[names(DAX.df.diff) == "DAX.dates"] <- "Date"
# rename column names for index data frames to "Percentage Difference"
names(SP500.df.diff)[names(
SP500.df.diff) == "SP500.diff"] <- "Percentage Difference"
names(NASDAQ.df.diff)[names(
NASDAQ.df.diff) == "NASDAQ.diff"] <- "Percentage Difference"
names(DJI.df.diff)[names(DJI.df.diff) == "DJI.diff"] <- "Percentage Difference"
names(TSX.df.diff)[names(TSX.df.diff) == "TSX.diff"] <- "Percentage Difference"
names(DAX.df.diff)[names(DAX.df.diff) == "DAX.diff"] <- "Percentage Difference"
# cast values in Date columns as Dates
# countries
CAN.CVD.df$Date <- as.Date(CAN.CVD.df$Date)
USA.CVD.df$Date <- as.Date(USA.CVD.df$Date)
DE.CVD.df$Date <- as.Date(DE.CVD.df$Date)
# indices
SP500.df.diff$Date <- as.Date(SP500.df.diff$Date)
NASDAQ.df.diff$Date <- as.Date(NASDAQ.df.diff$Date)
DJI.df.diff$Date <- as.Date(DJI.df.diff$Date)
TSX.df.diff$Date <- as.Date(TSX.df.diff$Date)
DAX.df.diff$Date <- as.Date(DAX.df.diff$Date)
# inner join merge of data frames for each country
# such that equal dates with values match
# USA
USA.SP500.diff.merged <- merge(x= USA.CVD.df, y=SP500.df.diff, by = 'Date')
USA.NASDAQ.diff.merged <- merge(x= USA.CVD.df, y=NASDAQ.df.diff, by = 'Date')
USA.DJI.diff.merged <- merge(x= USA.CVD.df, y=DJI.df.diff, by = 'Date')
# Canada
CAN.TSX.diff.merged <- merge(x= CAN.CVD.df, y=TSX.df.diff, by = 'Date')
# Germany
DE.DAX.diff.merged <- merge(x= DE.CVD.df, y=DAX.df.diff, by = 'Date')
# test correlation
# USA
cor(USA.SP500.diff.merged$`Percentage Difference`,
USA.SP500.diff.merged$`Daily cases`)
cor(USA.NASDAQ.diff.merged$`Percentage Difference`,
USA.NASDAQ.diff.merged$`Daily cases`)
cor(USA.DJI.diff.merged$`Percentage Difference`,
USA.NASDAQ.diff.merged$`Daily cases`)
# Canada
cor(CAN.TSX.diff.merged$`Percentage Difference`,
CAN.TSX.diff.merged$`Daily cases`)
# Germany
cor(DE.DAX.diff.merged$`Percentage Difference`,
DE.DAX.diff.merged$`Daily cases`)
# write csv files for each country covid data merged with
# country index data for percentage difference in stock daily high and low
#SP500 & USA
write.csv(USA.SP500.diff.merged, paste(p.output,
"USA.SP500.diff.merged.csv",
sep = ""), row.names = FALSE)
# NASDAQ & USA
write.csv(USA.NASDAQ.diff.merged, paste(p.output,
"USA.NASDAQ.diff.merged.csv",
sep = ""), row.names = FALSE)
#DJI & USA
write.csv(USA.DJI.diff.merged, paste(p.output,
"USA.DJI.diff.merged.csv",
sep = ""), row.names = FALSE)
# TSX & Canada
write.csv(CAN.TSX.diff.merged, paste(p.output,
"CAN.TSX.diff.merged.csv",
sep = ""), row.names = FALSE)
# DAX & Germany
write.csv(DE.DAX.diff.merged, paste(p.output,
"DE.DAX.diff.merged.csv",
sep = ""), row.names = FALSE)
# === 5) analysis for percent change ===========================================
# section finds percent change between index stock price at
# market open and close
# correlation is run for daily cases and daily index stock percent change
# csv files are saved from dataframes for the creation of figures
# function to calculate percent change for daily stock price between
# opening value and closing value
percent.change <- function(open,close){
top.c <- close - open
bottom.c <- open
final.c <- (top.c / bottom.c)*100
return(final.c)
}
# Create data frames to run correlation between
# daily covid cases and percent change between index stock price open and close
# create vectors for daily percent change in stock price
# for each index by USA covid dates
# SP500
SP500.change <- percent.change((fmt.by.date(csv.SP500$Open, csv.SP500$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2])),
(fmt.by.date(csv.SP500$Close.Last, csv.SP500$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2])))
# NASDAQ
NASDAQ.change <- percent.change((fmt.by.date(csv.NASDAQ$Open, csv.NASDAQ$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2])),
(fmt.by.date(csv.NASDAQ$Close, csv.NASDAQ$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2])))
# DJI
DJI.change <- percent.change((fmt.by.date(csv.DJI$Open, csv.DJI$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2])),
(fmt.by.date(csv.DJI$Price, csv.DJI$Date,
USA.CVD.dates.min.max[1],
USA.CVD.dates.min.max[2])))
# create vectors for daily percent change in stock price
# TSX
TSX.change <- percent.change((fmt.by.date(csv.TSX$Open, csv.TSX$Date,
CAN.CVD.dates.min.max[1],
CAN.CVD.dates.min.max[2])),
(fmt.by.date(csv.TSX$Close, csv.TSX$Date,
CAN.CVD.dates.min.max[1],
CAN.CVD.dates.min.max[2])))
# create vectors for daily percent change in stock price
# DAX
DAX.change <- percent.change((fmt.by.date(csv.DAX$Open, csv.DAX$Date,
DE.CVD.dates.min.max[1],
DE.CVD.dates.min.max[2])),
(fmt.by.date(csv.DAX$Price, csv.DAX$Date,
DE.CVD.dates.min.max[1],
DE.CVD.dates.min.max[2])))
# create data frame for daily percent change in stock price from each index
# by associated dates sorted by covid data
# SP500
SP500.df.change <- cbind.data.frame(SP500.dates, SP500.change)
# NASDAQ
NASDAQ.df.change <- cbind.data.frame(NASDAQ.dates, NASDAQ.change)
# DJI
DJI.df.change <- cbind.data.frame(DJI.dates, DJI.change)
# TSX
TSX.df.change <- cbind.data.frame(TSX.dates, TSX.change)
# DAX
DAX.df.change <- cbind.data.frame(DAX.dates, DAX.change)
# rename column names for index data frame dates to "Date"
names(SP500.df.change)[names(SP500.df.change) == "SP500.dates"] <- "Date"
names(NASDAQ.df.change)[names(NASDAQ.df.change) == "NASDAQ.dates"] <- "Date"
names(DJI.df.change)[names(DJI.df.change) == "DJI.dates"] <- "Date"
names(TSX.df.change)[names(TSX.df.change) == "TSX.dates"] <- "Date"
names(DAX.df.change)[names(DAX.df.change) == "DAX.dates"] <- "Date"
# rename column names for index data frames to "Change in price"
names(SP500.df.change)[names(
SP500.df.change) == "SP500.change"] <- "Change in price"
names(NASDAQ.df.change)[names(
NASDAQ.df.change) == "NASDAQ.change"] <- "Change in price"
names(DJI.df.change)[names(DJI.df.change) == "DJI.change"] <- "Change in price"
names(TSX.df.change)[names(TSX.df.change) == "TSX.change"] <- "Change in price"
names(DAX.df.change)[names(DAX.df.change) == "DAX.change"] <- "Change in price"
# cast values in Date columns as Dates
# countries
CAN.CVD.df$Date <- as.Date(CAN.CVD.df$Date)
USA.CVD.df$Date <- as.Date(USA.CVD.df$Date)
DE.CVD.df$Date <- as.Date(DE.CVD.df$Date)
# indices
SP500.df.change$Date <- as.Date(SP500.df.change$Date)
NASDAQ.df.change$Date <- as.Date(NASDAQ.df.change$Date)
DJI.df.change$Date <- as.Date(DJI.df.change$Date)
TSX.df.change$Date <- as.Date(TSX.df.change$Date)
DAX.df.change$Date <- as.Date(DAX.df.change$Date)
# inner join merge of data frames for each country
# such that equal dates with values match
# USA
USA.SP500.change.merged <- merge(x= USA.CVD.df,
y=SP500.df.change, by = 'Date')
USA.NASDAQ.change.merged <- merge(x= USA.CVD.df,
y=NASDAQ.df.change, by = 'Date')
USA.DJI.change.merged <- merge(x= USA.CVD.df, y=DJI.df.change, by = 'Date')
# Canada
CAN.TSX.change.merged <- merge(x= CAN.CVD.df, y=TSX.df.change, by = 'Date')
# Germany
DE.DAX.change.merged <- merge(x= DE.CVD.df, y=DAX.df.change, by = 'Date')
# test correlation
# USA
cor(USA.SP500.change.merged$`Change in price`,
USA.SP500.diff.merged$`Daily cases`)
cor(USA.NASDAQ.change.merged$`Change in price`,
USA.NASDAQ.diff.merged$`Daily cases`)
cor(USA.DJI.change.merged$`Change in price`,
USA.NASDAQ.diff.merged$`Daily cases`)
# Canada
cor(CAN.TSX.change.merged$`Change in price`, CAN.TSX.diff.merged$`Daily cases`)
# Germany
cor(DE.DAX.change.merged$`Change in price`, DE.DAX.diff.merged$`Daily cases`)
# write csv files for each country covid data merged with
# country index data for percentage change in stock price at opening and closing
#SP500 & USA
write.csv(USA.SP500.change.merged, paste(p.output,
"USA.SP500.change.merged.csv",
sep = ""), row.names = FALSE)
# NASDAQ & USA
write.csv(USA.NASDAQ.change.merged, paste(p.output,
"USA.NASDAQ.change.merged.csv",
sep = ""), row.names = FALSE)
#DJI & USA
write.csv(USA.DJI.change.merged, paste(p.output,
"USA.DJI.change.merged.csv",
sep = ""), row.names = FALSE)
# TSX & Canada
write.csv(CAN.TSX.change.merged, paste(p.output,
"CAN.TSX.change.merged.csv",
sep = ""), row.names = FALSE)
# DAX & Germany
write.csv(DE.DAX.change.merged, paste(p.output,
"DE.DAX.change.merged.csv",
sep = ""), row.names = FALSE)
#___ end _______________________________________________________________________
# === Figures ==================================================================
# 1.Main.R is required to run first to acces folder paths
# read cleaned csv files
# percent difference csv files
USA.SP500.diff.merged <- read.csv(paste(p.output,
"USA.SP500.diff.merged.csv", sep = ""))
USA.NASDAQ.diff.merged <- read.csv(paste(p.output,
"USA.NASDAQ.diff.merged.csv", sep = ""))
USA.DJI.diff.merged <- read.csv(paste(p.output,
"USA.DJI.diff.merged.csv",sep = ""))
CAN.TSX.diff.merged <- read.csv(paste(p.output,
"CAN.TSX.diff.merged.csv", sep = ""))
DE.DAX.diff.merged <- read.csv(paste(p.output,
"DE.DAX.diff.merged.csv", sep = ""))
# percent change csv files
USA.SP500.change.merged <- read.csv(paste(p.output,
"USA.SP500.change.merged.csv", sep = ""))
USA.NASDAQ.change.merged <- read.csv(paste(p.output,
"USA.NASDAQ.change.merged.csv", sep = ""))
USA.DJI.change.merged <- read.csv(paste(p.output,
"USA.DJI.change.merged.csv",sep = ""))
CAN.TSX.change.merged <- read.csv(paste(p.output,
"CAN.TSX.change.merged.csv", sep = ""))
DE.DAX.change.merged <- read.csv(paste(p.output,
"DE.DAX.change.merged.csv", sep = ""))
#===========Variables for Graphs================================================
dotsColor <- 'grey'
dotsForm <- 16
dotsSize <-0.7
lineColor <- 'red'
lineSize <- 3
textSize <- 1
#===========Columns to Variables================================================
#
#
#
#
USA.PercDiff.DJI <-USA.DJI.diff.merged$Percentage.Difference
USA.Cases.DJI <- USA.DJI.diff.merged$Daily.cases
USA.PercDiff.Nasdaq <- USA.NASDAQ.diff.merged$Percentage.Difference
USA.Cases.Nasdaq <- USA.NASDAQ.diff.merged$Daily.cases
USA.PercDiff.SP500 <- USA.SP500.diff.merged$Percentage.Difference
USA.Cases.SP500 <- USA.SP500.diff.merged$Daily.cases
#USA.Cases.DJI2 <- USA.Cases.DJI^2
Can.PercDiff <- CAN.TSX.diff.merged$Percentage.Difference
Can.Cases <- CAN.TSX.diff.merged$Daily.cases
#Can.Cases2 <- Can.Cases^2
Ger.PercDiff <- DE.DAX.diff.merged$Percentage.Difference
Ger.Cases <- DE.DAX.diff.merged$Daily.cases
#Ger.Cases2 <- Ger.Cases^2
USA.PercChange.DJI <- USA.DJI.change.merged$Change.in.price
USA.PercChange.Nasdaq <- USA.NASDAQ.change.merged$Change.in.price
USA.PercChange.SP500 <- USA.SP500.change.merged$Change.in.price
Can.PercChange <- CAN.TSX.change.merged$Change.in.price
Ger.PercChange <- DE.DAX.change.merged$Change.in.price
#===========Plotting percent change for the US==========================================
pdf(paste(p.fig, "UScorrelationCHANGE.pdf", sep = ""))
par(mfrow=c(3,1))
plot(USA.Cases.DJI,
USA.PercChange.DJI,
xlab =  "Covid Cases", ylab = "Change DJI",
main = "USA - DJI correlation", pch = dotsForm, cex = dotsSize,
col = dotsColor, las = 1)
abline(lm(USA.PercChange.DJI ~ USA.Cases.DJI), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(USA.Cases.DJI,
USA.PercChange.DJI), 2)), x = 200000, y = 4, cex = 1)
plot(USA.Cases.Nasdaq,
USA.PercChange.Nasdaq,
xlab =  "Covid Cases", ylab = "Change NASDAQ",
main = "USA - NASDAQ correlation", pch = dotsForm, cex = dotsSize,
col = dotsColor,  las = 1)
abline(lm(USA.PercChange.Nasdaq ~
USA.Cases.Nasdaq), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(USA.Cases.Nasdaq,
USA.PercChange.Nasdaq),
2)), x = 200000, y = 4, cex = 1)
plot(USA.Cases.SP500,
USA.PercChange.SP500,
xlab =  "Covid Cases", ylab = "Change SP500",
main = "USA - SP500 correlation", pch = dotsForm, cex = dotsSize,
col = dotsColor, las = 1)
abline(lm(USA.PercChange.SP500 ~
USA.Cases.SP500), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(USA.Cases.SP500,
USA.PercChange.SP500),
2)), x = 200000, y = 4, cex = 1)
dev.off()
#===========Plotting percent change for countries==========================================
pdf(paste(p.fig, "PercChangeCountries.pdf", sep = ""))
par(mfrow=c(3,1))
plot(USA.Cases.DJI, USA.PercChange, xlab =  "Covid Cases",
ylab = "Percentage Change DJI",
main = "USA - DJI correlation", pch = dotsForm, cex = dotsSize,
col = dotsColor, las = 1 )
abline(lm(USA.PercChange ~
USA.Cases.DJI), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(USA.Cases.DJI, USA.PercChange), 3)),
x = 200000, y = -3, cex = textSize)
plot(Can.Cases, Can.PercChange, xlab = "Covid Cases",
ylab = "Percentage Change TSX",
main = "Can - TSX correlation", pch = dotsForm,
cex = dotsSize, col = dotsColor, las = 1)
abline(lm(Can.PercChange ~
Can.Cases), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(Can.Cases,
Can.PercChange), 3)),x = 6000, y = -3,
cex = textSize)
plot(Ger.Cases, Ger.PercChange, xlab =  "Covid Cases",
ylab = "Percentage Change DAX",
main = "Ger - DAX correlation",
pch = dotsForm, cex = dotsSize, col = dotsColor, las = 1 )
abline(lm(Ger.PercChange ~
Ger.Cases), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(Ger.Cases, Ger.PercChange), 3)),
x = 60000, y = -3, cex = textSize)
dev.off()
#===========Plotting difference for the US======================================
#US GRAPH for 3 indices: plotting three graphs !!!percentage difference
pdf(paste(p.fig, "UScorrelationDIFF.pdf", sep = ""))
par(mfrow=c(3,1))
plot(USA.Cases.DJI,
USA.PercDiff.DJI,
xlab =  "Covid Cases", ylab = "Percentage Difference DJI",
main = "USA - DJI correlation", pch = dotsForm, cex = dotsSize,
col = dotsColor, las = 1)
abline(lm(USA.PercDiff.DJI ~ USA.Cases.DJI), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(USA.Cases.DJI,
USA.PercDiff.DJI), 2)), x = 200000,
y = 4, cex = 1)
plot(USA.Cases.Nasdaq,
USA.PercDiff.Nasdaq,
xlab =  "Covid Cases", ylab = "Percentage Difference NASDAQ",
main = "USA - NASDAQ correlation", pch = dotsForm, cex = dotsSize,
col = dotsColor,  las = 1)
abline(lm(USA.PercDiff.Nasdaq ~
USA.Cases.Nasdaq), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(USA.Cases.Nasdaq,
USA.PercDiff.Nasdaq),
2)), x = 200000, y = 4, cex = 1)
plot(USA.Cases.SP500,
USA.PercDiff.SP500,
xlab =  "Covid Cases", ylab = "Percentage Difference SP500",
main = "USA - SP500 correlation", pch = dotsForm, cex = dotsSize,
col = dotsColor, las = 1)
abline(lm(USA.PercDiff.SP500 ~
USA.Cases.SP500), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(USA.Cases.SP500,
USA.PercDiff.SP500),
2)), x = 200000, y = 4, cex = 1)
dev.off()
#===========Plotting difference for countries===================================
pdf(paste(p.fig, "PercDifferenceCountries.pdf", sep = ""))
par(mfrow=c(3,1))
plot(USA.Cases.DJI,
USA.PercDiff.DJI,
xlab =  "Covid Cases", ylab = "Percentage Difference DJI",
main = "USA - DJI correlation", pch = dotsForm, cex = dotsSize,
col = dotsColor, las = 1)
abline(lm(USA.PercDiff.DJI ~
USA.Cases.DJI), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(USA.Cases.DJI,
USA.PercDiff.DJI),
2)), x = 200000, y = 6, cex = 1)
plot(Can.Cases,
Can.PercDiff,
xlab =  "Covid Cases", ylab = "Percentage Difference TSX",
main = "Canada - TSX correlation", pch = dotsForm, cex = dotsSize,
col = dotsColor, las = 1)
abline(lm(Can.PercDiff ~ Can.Cases), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(Can.Cases,
Can.PercDiff),
2)), x = 6000, y = 6, cex = 1)
plot(Ger.Cases,
Ger.PercDiff,
xlab =  "Covid Cases", ylab = "Percentage Difference DEX",
main = "Germany - DEX correlation", pch = dotsForm, cex = dotsSize,
col = dotsColor, las = 1)
abline(lm(Ger.PercDiff ~
Ger.Cases), col = lineColor, lwd = lineSize)
text(paste("Correlation:", round(cor(Ger.Cases,
Ger.PercDiff),
2)), x = 50000, y = 6, cex = 1)
dev.off()
#===========RegressionModel==========================================
# USA.PercDiff.DJI.quadratic.model <- lm(USA.PercDiff.DJI
# ~ USA.Cases.DJI + USA.Cases.DJI2)
#summary(USA.PercDiff.DJI.quadratic.model)
#linear <- lm(USA.PercDiff.DJI ~ USA.Cases.DJI)
#summary(linear)
# coef(USA.PercDiff.DJI.quadratic.model)
# Can.PercDiff.quadratic.model <- lm(Can.PercDiff ~ Can.Cases + Can.Cases2)
# summary(Can.PercDiff.quadratic.model)
# Ger.PercDiff.quadratic.model <- lm(Ger.PercDiff ~ Ger.Cases + Ger.Cases2)
# summary(Ger.PercDiff.quadratic.model)
# USA.PercChange.quadratic.model <- lm(USA.PercChange ~ USA.Cases.DJI
# + USA.Cases.DJI2)
# summary(USA.PercChange.quadratic.model)
# USA.PercChange.linear.model <- lm(USA.PercChange ~ USA.Cases.DJI)
# summary(USA.PercChange.linear.model)
#===========PlottingRegressionModel==========================================
# values <- seq(0, 3000000, 1)
# USA.predicted <- predict(USA.PercDiff.DJI.quadratic.model,
# list(USA.Cases.DJI = values, USA.Cases.DJI2 = values^2))
# Can.predicted <- predict(Can.PercDiff.quadratic.model,
#                         list(Can.Cases = values, Can.Cases2 = values^2))
# Ger.predicted <- predict(Ger.PercDiff.quadratic.model,
#                         list(Ger.Cases = values, Ger.Cases2 = values^2))
#
# USA.change.predicted <- predict(USA.PercChange.quadratic.model,
#                       list(USA.Cases.DJI = values, USA.Cases.DJI2 = values^2))
# coefficients(USA.PercDiff.DJI.quadratic.model)
# #saving 3 plots in one pdf
# pdf(paste(p.fig, "QuadraticCountries.pdf", sep = ""))
# par(mfrow=c(3,1))
# plot(USA.Cases.DJI, USA.PercDiff.DJI, xlab =  "Covid Cases",
# ylab = "Percentage Difference DJI",
#      main = "USA - DJI correlation", pch = dotsForm,
# cex = dotsSize, col = dotsColor, las = 1 )
# lines(values, USA.predicted, col = lineColor, lwd = lineSize)
# #text(paste('y =', round(coef(USA.PercDiff.DJI.quadratic.model)[[2]],
# digits = 3), '* USA.Cases.DJI', '+',
# round(coef(USA.PercDiff.DJI.quadratic.model)[[1]],
#                                                                                                         #digits = 3), x = 200000, y = 4, cex = 1)
# plot(Can.Cases, Can.PercDiff, xlab =  "Covid Cases",
# ylab = "Percentage Difference TSX",
#      main = "Canada - TSX correlation", pch = dotsForm,
# cex = dotsSize, col = dotsColor, las = 1 )
# lines(values, Can.predicted, col = lineColor, lwd = lineSize)
# plot(Ger.Cases, Ger.PercDiff, xlab =  "Covid Cases",
# ylab = "Percentage Difference DEX",
#      main = "Germany - DEX correlation",
# pch = dotsForm, cex = dotsSize, col = dotsColor, las = 1 )
# lines(values, Ger.predicted, col = lineColor, lwd = lineSize)
#
# dev.off()
